import slash
from datetime import datetime
from os import path
import os,sys

project_root = os.getenv('PROJECT_ROOT')
if not project_root:
	slash.logger.error('PROJECT_ROOT enviroment variable is not set, did you run env?')
	sys.exit(-1)

suite_name = path.basename(path.dirname(path.abspath(__file__)))
externals = 'externals'
dut_chroot = '/data/debian'
resources_remote = 'root'

config = {
        
        'paths' : {
            'results' : path.join(project_root, externals, suite_name, 'results'),
            'resources' : path.join(project_root, externals, suite_name, 'resources'),
            'resources_remote' : path.join('/', resources_remote), # Path of resources on DUT
            'resources_remote_adb' : path.join(dut_chroot, resources_remote),
            'results_file' : 'measurements.csv',
            'suite_name' : suite_name,
            'project_root' : project_root,
            'externals' : externals,
            'chroot' : dut_chroot
        },
        
        'thresholds' : {
            'cpu_max'   : 0.9,
            'mem_max'   : 900000000,
            'bat_max'   : (0.25*1.05) / 60, # (=0.004375) batt use per sec. (out of 100)
            'time_max'  : 0 

        }
}

slash.config.root.log.root = config['paths']['results']
slash.config.root.log.localtime = True
timestamp = datetime.now().strftime('%d-%m-%y_%H-%M-%S')
slash.config.root.log.subpath = timestamp + "/{context.test}/log"
slash.config.root.log.session_subpath = timestamp + "/session.log"
slash.config.extend(config)
